# 시료 접수 대장 앱 개발 작업 내역

## 프로젝트 개요
- **프로젝트명**: sample-log-electron
- **GitHub**: https://github.com/bluesky78060/sample-log-electron
- **배포**:
  - 데스크톱: GitHub Releases (Windows .exe)
  - 웹: GitHub Pages (https://bluesky78060.github.io/sample-log-electron/)

---

## 시료 유형별 개발 현황

| 시료 유형 | 상태 | 비고 |
|-----------|------|------|
| 🌱 토양 | ✅ 완료 | 필지별 개별 접수, 연도별 자동 저장 |
| 💧 수질 | ✅ 완료 | 채취장소별 개별 접수, 생활용수/농업용수 검사항목 |
| 🧫 잔류농약 | ✅ 완료 | 다중 의뢰 기능, 연도별 자동 저장 |
| 🐄 퇴·액비 | ✅ 완료 | 가축분뇨퇴비 시료 접수, 연도별 자동 저장 |
| ⚠️ 중금속 | ✅ 완료 | 토양 중금속 검사, 연도별 자동 저장 |

---

## 파일 구조

```
sample-log-electron/
├── src/
│   ├── index.html           # 메인 선택 페이지
│   ├── index.js             # Electron 메인 프로세스
│   ├── preload.js           # IPC 브릿지
│   ├── style.css            # 공통 스타일
│   ├── script.js            # 공통 스크립트
│   ├── cropData.js          # 작물 데이터
│   ├── bonghwaData.js       # 지역 데이터
│   ├── soil/                # 토양 시료
│   │   ├── index.html
│   │   └── soil-script.js
│   ├── water/               # 수질 시료
│   │   ├── index.html
│   │   └── water-script.js
│   ├── pesticide/           # 잔류농약 시료
│   │   ├── index.html
│   │   └── pesticide-script.js
│   ├── compost/             # 퇴·액비 시료
│   │   ├── index.html
│   │   └── compost-script.js
│   ├── heavy-metal/         # 중금속 시료
│   │   ├── index.html
│   │   └── heavy-metal-script.js
│   └── label-print/         # 라벨 인쇄
│       ├── index.html
│       └── label-app.js
├── docs/                    # GitHub Pages 웹 버전 (src 미러)
├── .github/
│   └── workflows/
│       └── build.yml        # GitHub Actions 워크플로우
├── forge.config.js          # Electron Forge 설정
└── package.json
```

---

## 완료된 시료 유형별 상세

### 🌱 토양 시료 접수 대장 (✅ 완료)

#### 시료 접수 폼
| 필드명 | 설명 |
|--------|------|
| 접수번호 | 자동 생성 (필지별 개별) |
| 접수일자 | 날짜 선택 |
| 성명 | 민원인 성명 |
| 전화번호 | 연락처 |
| 주소 | 우편번호 + 도로명 + 상세주소 |
| 구분 | 논, 밭, 과수, 시설 |
| 목적(용도) | 일반재배, 무농약, 유기, GAP, 저탄소 |
| 필지 정보 | 필지 주소, 하위 필지, 작물명, 면적 (다중 등록) |
| 수령 방법 | 우편, 이메일, 팩스, 직접방문 |
| 비고 | 추가 메모 |

#### 테이블 컬럼
`완료 | 접수번호 | 접수일자 | 구분 | 목적 | 성명 | 우편번호 | 주소 | 필지주소 | 작물명 | 면적 | 전화번호 | 수령방법 | 비고 | 관리`

---

### 💧 수질 시료 접수 대장 (✅ 완료)

#### 시료 접수 폼
| 필드명 | 설명 |
|--------|------|
| 접수번호 | 자동 생성 (채취장소별 개별) |
| 접수일자 | 날짜 선택 |
| 성명 | 민원인 성명 |
| 전화번호 | 연락처 |
| 주소 | 우편번호 + 도로명 + 상세주소 |
| 시료명 | 지하수, 하천수, 저수지, 수돗물, 기타 |
| 채취장소 | 리+지번 (다중 입력 가능) |
| 주작목 | 채취장소별 주작목 |
| 목적 | 참고용, 민원, 기타 |
| 검사항목 | 생활용수(20항목), 농업용수(15항목) |
| 수령 방법 | 통보방법 선택 |
| 비고 | 추가 메모 |

#### 검사항목 상세
- **생활용수 (20항목)**: pH, EC, 총대장균군, 질산성질소, 염소이온, 카드뮴, 비소, 시안, 수은, 납, 6가크롬, 셀레늄, 페놀, 벤젠, 톨루엔, 에틸벤젠, 크실렌, 트리클로로에틸렌, 테트라클로로에틸렌, 1,1,1-트리클로로에탄
- **농업용수 (15항목)**: pH, EC, COD, SS, DO, 총질소, 총인, 카드뮴, 비소, 수은, 납, 크롬, 구리, 아연, 대장균군

---

### 🧫 잔류농약 시료 접수 대장 (✅ 완료)

#### 시료 접수 폼
| 필드명 | 설명 |
|--------|------|
| 접수번호 | 자동 생성 |
| 접수일자 | 날짜 선택 |
| 성명 | 민원인 성명 |
| 전화번호 | 연락처 |
| 주소 | 우편번호 + 도로명 + 상세주소 |
| 농산물명 | 검사 대상 농산물 (작물 선택) |
| 재배지 주소 | 농산물 재배지 |
| 출하 예정일 | 농산물 출하 예정일 |
| 인증 종류 | 무농약, 유기, GAP, 저탄소, 일반 |
| 수령 방법 | 우편, 이메일, 팩스, 직접방문 |
| 비고 | 추가 메모 |

#### 특수 기능
- 다중 의뢰 기능 (한 번에 여러 건 접수)

---

### 🐄 퇴·액비 시료 접수 대장 (✅ 완료)

#### 시료 접수 폼
| 필드명 | 설명 |
|--------|------|
| 접수번호 | 자동 생성 |
| 접수일자 | 날짜 선택 |
| 성명/업체명 | 생산자 또는 업체명 |
| 전화번호 | 연락처 |
| 주소 | 우편번호 + 도로명 + 상세주소 |
| 퇴비 종류 | 돈분, 우분, 계분, 혼합, 기타 |
| 생산지 주소 | 퇴비 생산 장소 |
| 생산일자 | 퇴비 생산일 |
| 검사 목적 | 품질검사, 부숙도검사, 성분분석, 기타 |
| 수령 방법 | 우편, 이메일, 팩스, 직접방문 |
| 비고 | 추가 메모 |

---

### ⚠️ 중금속 시료 접수 대장 (✅ 완료)

#### 시료 접수 폼
| 필드명 | 설명 |
|--------|------|
| 접수번호 | 자동 생성 |
| 접수일자 | 날짜 선택 |
| 성명 | 민원인 성명 |
| 전화번호 | 연락처 |
| 주소 | 우편번호 + 도로명 + 상세주소 |
| 시료 종류 | 토양, 농산물, 용수, 기타 |
| 채취 위치 | 시료 채취 장소 |
| 채취일자 | 시료 채취일 |
| 검사 항목 | 납, 카드뮴, 비소, 수은, 크롬, 구리, 아연, 니켈 (다중 선택) |
| 오염 의심 원인 | 공장, 폐기물, 농약, 자연발생, 기타 |
| 수령 방법 | 우편, 이메일, 팩스, 직접방문 |
| 비고 | 추가 메모 |

---

## 공통 기능

### 연도별 자동 저장 (✅ 완료)
- 연도 선택 드롭다운 (2024년 ~ 2030년)
- 연도별 별도 JSON 파일 저장: `auto-save-{type}-{year}.json`
- 연도 변경 시 해당 연도 데이터 자동 로드
- localStorage와 파일 동기화

### 네비게이션 시스템 (✅ 완료)
- 드롭다운 메뉴로 시료 유형 선택
- 뒤로가기 버튼 (메인 페이지 이동)
- 페이지 간 이동 시 데이터 유지

### 라벨 인쇄 기능 (✅ 완료)
- A4 라벨지 2열 9행 (18개) 템플릿
- 시작 위치 선택 (라벨지 절약)
- 시각적 그리드 프리뷰
- 엑셀 파일 업로드 지원
- 동일인 중복 제거

### 엑셀 내보내기 (✅ 완료)
- 전체 필드 포함 내보내기
- 시료 유형별 맞춤 컬럼

### 통계 기능 (✅ 완료)
- 총 접수/완료/미완료 건수
- 시료 타입별 통계
- 목적(용도)별 통계
- 월별 접수 현황
- 수령 방법별 통계

---

## 완료된 작업

### UI/UX 개선
- [x] 검색 모달 디자인 (둥근 모서리, 아이콘 배경색)
- [x] 테이블 행 높이 축소
- [x] 체크박스 선택 기능 (전체/개별 선택)
- [x] 주소/우편번호 분리
- [x] 전체 보기/기본 보기 토글
- [x] 필지 입력 UI 개선
- [x] 하위 필지 레이아웃 정리
- [x] 비고 입력창 100% 너비

### 데이터 관리
- [x] 연도별 데이터 분리 저장
- [x] 자동 저장 파일에서 자동 로드
- [x] 선택 삭제 기능
- [x] 데이터 백업/복원

### GitHub 배포
- [x] GitHub Actions 워크플로우
- [x] Windows .exe 자동 빌드
- [x] GitHub Releases 자동 업로드
- [x] GitHub Pages 웹 배포

---

## 커밋 히스토리 (최근)

| 커밋 | 설명 |
|------|------|
| `b556efc` | feat: 연도별 자동저장 및 UI 개선 |
| `699dc52` | feat: 모든 페이지에 년도 선택 기능 추가 및 docs 동기화 |
| `1816feb` | feat: 잔류농약 검사 페이지 추가 및 다중 의뢰 기능 구현 |
| `bf0a672` | feat: 엑셀 내보내기 전체 필드 포함 기능 개선 |
| `99e48f4` | fix: 중금속/퇴액비 페이지 버그 수정 및 기능 개선 |
| `bae078a` | refactor: 토양 중금속 페이지 개선 |
| `3b586d6` | feat: 메인 페이지 토양 중금속 카드 활성화 |
| `ab76671` | feat: 토양 중금속 시료 접수 대장 페이지 추가 |
| `329e59a` | feat: 드롭다운 네비게이션 추가 및 자동저장 기능 완성 |
| `413241b` | feat: 퇴·액비 시료 접수 기능 추가 및 라벨 인쇄 연결 |
| `4af6df8` | feat: 시료 종류별 페이지 분리 및 수질분석 시스템 구현 |

---

## 기술 스택

- **프레임워크**: Electron + Electron Forge
- **프론트엔드**: HTML, CSS, JavaScript (Vanilla)
- **스타일링**: Tailwind CSS, Custom CSS
- **라이브러리**:
  - XLSX.js (엑셀 파일 처리)
  - Daum Postcode API (주소 검색)
- **빌드**: Electron Forge (Squirrel, ZIP)
- **CI/CD**: GitHub Actions
- **배포**: GitHub Releases, GitHub Pages

---

## 향후 작업 (예정)

### 기능 개선
- [ ] 추가 라벨 템플릿 지원 (3x7, 4x6 등)
- [ ] 다크 모드 지원
- [ ] macOS 빌드 추가
- [ ] 검사 결과 입력 및 관리 기능
- [ ] 결과 보고서 출력 기능
- [ ] 인쇄 미리보기 개선

### 데이터 관리
- [ ] 클라우드 동기화 기능
- [ ] 다중 사용자 지원
- [ ] 데이터 암호화

### UI/UX
- [ ] 반응형 디자인 개선
- [ ] 접근성 향상
- [ ] 키보드 네비게이션

### 보안
- [ ] innerHTML XSS 위험 개선 - DOMPurify 라이브러리 도입 검토
  - 대부분의 innerHTML 사용은 정적 템플릿이나, 사용자 입력이 포함될 경우 주의 필요
  - 웹 버전 공개 배포 시 또는 외부 API 데이터 표시 시 적용 권장

### 코드 구조
- [ ] style.css 파일 분리 검토 (현재 3,984줄)
  - 현재 단일 파일로 성능 문제 없음, 필요시 모듈화 진행
  - 분리 시 구조: variables, navbar, forms, tables, modals, pagination, utilities
- [ ] ESLint 도입 검토
  - 현재 미설정 상태, 개인 프로젝트로 급하지 않음
  - 팀 협업 또는 프로젝트 확장 시 도입 권장
- [ ] TypeScript 마이그레이션
  - 타입 안정성 향상, IDE 지원 개선
  - 점진적 마이그레이션 가능 (allowJs: true)
- [ ] 단위 테스트 추가
  - Vitest 또는 Jest 도입
  - 현재 E2E 테스트(Playwright)만 있음, 개별 함수 테스트 필요
