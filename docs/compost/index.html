<!DOCTYPE html>
<html lang="ko" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>퇴·액비 성분검사 위탁서</title>
    <!-- 폰트 preconnect 및 preload로 성능 최적화 (bundle-defer-third-party) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" media="print" onload="this.media='all'">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap"></noscript>
    <link rel="preload" as="style" href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" media="print" onload="this.media='all'">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined"></noscript>
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <script>
        tailwind.config = {
            darkMode: ['selector', '[data-theme="dark"]'],
            theme: {
                extend: {
                    colors: {
                        primary: "#3B82F6",
                        "background-light": "#F8FAFC",
                        "background-dark": "#18181B",
                    },
                    fontFamily: {
                        display: ["Noto Sans KR", "sans-serif"],
                    },
                    borderRadius: {
                        DEFAULT: "12px",
                    },
                },
            },
        };
    </script>
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="compost-style.css">
    <style>
        /* 다크 모드 select 강제 적용 - 최우선 */
        [data-theme="dark"] select#subCategory,
        [data-theme="dark"] select#purpose,
        [data-theme="dark"] select#sampleName,
        [data-theme="dark"] .form-card .card-body select {
            -webkit-appearance: none !important;
            -moz-appearance: none !important;
            appearance: none !important;
            background-color: rgba(69, 26, 3, 0.95) !important;
            color: #fcd34d !important;
            border-color: rgba(217, 119, 6, 0.4) !important;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23fcd34d' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='m6 9 6 6 6-6'/%3E%3C/svg%3E") !important;
            background-repeat: no-repeat !important;
            background-position: right 12px center !important;
            background-size: 16px !important;
            padding-right: 40px !important;
        }
        [data-theme="dark"] select#subCategory option,
        [data-theme="dark"] select#purpose option,
        [data-theme="dark"] select#sampleName option,
        [data-theme="dark"] .form-card .card-body select option {
            background-color: #451a03 !important;
            color: #fcd34d !important;
        }
    </style>
</head>

<body class="compost-page">
    <!-- 네비게이션 바 -->
    <nav class="navbar compost-navbar">
        <!-- 뒤로가기 버튼 -->
        <a href="../index.html" class="back-btn" title="메인으로">←</a>
        <!-- 로고 및 파트 선택 드롭다운 -->
        <div class="navbar-brand">
            <div class="brand-dropdown-trigger">
                <span class="brand-icon">🐄</span>
                <span class="brand-text">퇴·액비</span>
                <span class="dropdown-arrow">▼</span>
            </div>
            <div class="brand-dropdown-menu">
                <div class="dropdown-header">시료 분석 메뉴</div>
                <a href="../soil/index.html" class="dropdown-item">
                    <span class="item-icon">🌱</span>
                    <span class="item-text">토양 분석</span>
                </a>
                <a href="../water/index.html" class="dropdown-item">
                    <span class="item-icon">💧</span>
                    <span class="item-text">수질 분석</span>
                </a>
                <a href="../compost/index.html" class="dropdown-item active">
                    <span class="item-icon">🐄</span>
                    <span class="item-text">퇴·액비 성분검사</span>
                </a>
                <div class="dropdown-divider"></div>
                <a href="../pesticide/index.html" class="dropdown-item">
                    <span class="item-icon">🧪</span>
                    <span class="item-text">잔류농약 검사</span>
                </a>
                <a href="../heavy-metal/index.html" class="dropdown-item">
                    <span class="item-icon">⚗️</span>
                    <span class="item-text">토양 중금속</span>
                </a>
                <div class="dropdown-divider"></div>
                <a href="../label-print/index.html" class="dropdown-item">
                    <span class="item-icon">🏷️</span>
                    <span class="item-text">라벨 인쇄</span>
                </a>
            </div>
        </div>

        <!-- 메인 네비게이션 -->
        <div class="navbar-nav">
            <button class="nav-btn active" data-view="form" title="시료 접수">
                <span class="nav-btn-icon">✏️</span>
            </button>
            <button class="nav-btn" data-view="list" title="접수 목록">
                <span class="nav-btn-icon">📊</span>
            </button>
        </div>

        <div class="navbar-divider"></div>

        <!-- 폼 액션 -->
        <div class="navbar-actions">
            <button type="button" id="navResetBtn" class="action-btn-icon reset" title="초기화">
                <span>🔄</span>
            </button>
            <button type="button" id="navSubmitBtn" class="action-btn-icon submit" title="접수 등록">
                <span>✅</span>
            </button>
        </div>

        <div class="navbar-spacer"></div>

        <!-- 유틸리티 -->
        <div class="navbar-utils">
            <button type="button" id="exportBtn" class="util-btn" title="엑셀 내보내기">📥</button>
            <button type="button" id="downloadTemplateNavBtn" class="util-btn" title="엑셀 서식 다운로드">📄</button>
            <label for="excelImportInput" class="util-btn" title="엑셀 가져오기">
                📊
                <input type="file" id="excelImportInput" accept=".xlsx,.xls,.csv" hidden>
            </label>
            <button type="button" id="saveJsonBtn" class="util-btn" title="JSON 저장">💾</button>
            <label for="loadJsonInput" class="util-btn" title="JSON 불러오기">
                📂
                <input type="file" id="loadJsonInput" accept=".json" hidden>
            </label>
            <button type="button" id="migrateBtn" class="util-btn" title="클라우드 마이그레이션">☁️</button>
        </div>

        <div class="navbar-divider"></div>

        <!-- 자동 저장 -->
        <div class="navbar-autosave">
            <label class="autosave-toggle" title="자동저장">
                <input type="checkbox" id="autoSaveToggle">
                <span class="toggle-track"></span>
            </label>
            <button type="button" id="selectAutoSaveFolderBtn" class="autosave-folder-btn" title="저장 폴더 변경">
                📁
            </button>
            <span id="autoSaveStatus" class="autosave-status">
                <span class="status-indicator"></span>
            </span>
        </div>

        <div class="navbar-divider"></div>

        <!-- 다크 모드 토글 -->
        <div class="theme-toggle" id="themeToggleContainer">
            <span class="theme-icon sun">☀️</span>
            <button class="theme-toggle-btn" id="themeToggleBtn" title="다크 모드 전환">
            </button>
            <span class="theme-icon moon">🌙</span>
        </div>
    </nav>

    <!-- 메인 콘텐츠 -->
    <main class="main-content">
        <!-- 시료 접수 폼 뷰 -->
        <div id="formView" class="view active">

            <form id="sampleForm" class="sample-form">
                <div class="form-two-column">
                    <!-- 왼쪽: 의뢰자 정보 -->
                    <div class="form-left-column">
                        <!-- 의뢰자 정보 카드 -->
                        <div class="form-card">
                            <div class="card-header">
                                <span class="card-icon">👤</span>
                                <h3>의뢰자</h3>
                                <div class="year-select-wrapper">
                                    <select id="yearSelect" class="year-select">
                                        <option value="2025">2025년</option>
                                        <option value="2026">2026년</option>
                                        <option value="2027">2027년</option>
                                        <option value="2028">2028년</option>
                                        <option value="2029">2029년</option>
                                        <option value="2030">2030년</option>
                                    </select>
                                </div>
                                <div class="reception-method-group">
                                    <button type="button" class="reception-method-btn" data-method="우편" title="우편">
                                        <span class="method-icon">📮</span>
                                    </button>
                                    <button type="button" class="reception-method-btn" data-method="이메일" title="이메일">
                                        <span class="method-icon">📧</span>
                                    </button>
                                    <button type="button" class="reception-method-btn" data-method="팩스" title="팩스">
                                        <span class="method-icon">📠</span>
                                    </button>
                                    <button type="button" class="reception-method-btn" data-method="방문" title="방문">
                                        <span class="method-icon">🚶</span>
                                    </button>
                                </div>
                                <input type="hidden" id="receptionMethod" name="receptionMethod">
                            </div>
                            <div class="card-body">
                                <div class="form-row">
                                    <div class="form-field">
                                        <label for="receptionNumber">접수번호</label>
                                        <input type="text" id="receptionNumber" name="receptionNumber"
                                            placeholder="자동 생성">
                                    </div>
                                    <div class="form-field">
                                        <label for="date">접수일자</label>
                                        <input type="date" id="date" name="date" required>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-field">
                                        <label for="applicantType">법인여부 <span class="required">*</span></label>
                                        <select id="applicantType" name="applicantType" required>
                                            <option value="개인">개인</option>
                                            <option value="법인">법인</option>
                                        </select>
                                    </div>
                                    <div class="form-field" id="birthDateField">
                                        <label for="birthDate">생년월일</label>
                                        <input type="text" id="birthDate" name="birthDate" placeholder="YYYYMMDD (예: 19850315)" maxlength="8" pattern="[0-9]{8}">
                                    </div>
                                    <div class="form-field hidden" id="corpNumberField">
                                        <label for="corpNumber">법인번호</label>
                                        <input type="text" id="corpNumber" name="corpNumber" placeholder="법인등록번호 13자리" maxlength="14">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-field">
                                        <label for="farmName">상호(농장명)</label>
                                        <input type="text" id="farmName" name="farmName" placeholder="농장명 또는 법인명">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-field">
                                        <label for="name">성명(대표자) <span class="required">*</span></label>
                                        <input type="text" id="name" name="name" required placeholder="대표자 성명">
                                    </div>
                                    <div class="form-field">
                                        <label for="phoneNumber">연락처 <span class="required">*</span></label>
                                        <input type="tel" id="phoneNumber" name="phoneNumber" required
                                            placeholder="010-0000-0000">
                                    </div>
                                </div>
                                <div class="form-row single">
                                    <div class="form-field full">
                                        <label for="addressPostcode">주소</label>
                                        <div class="address-group">
                                            <div class="address-row">
                                                <input type="text" id="addressPostcode" name="addressPostcode" readonly
                                                    placeholder="우편번호" class="postcode-input">
                                                <button type="button" id="searchAddressBtn" class="btn-search">
                                                    🔍 주소 검색
                                                </button>
                                            </div>
                                            <input type="text" id="addressRoad" name="addressRoad" readonly
                                                placeholder="도로명 주소">
                                            <input type="text" id="addressDetail" name="addressDetail" placeholder="상세 주소 입력">
                                        </div>
                                        <input type="hidden" id="address" name="address">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-field full">
                                        <label for="farmAddressFull">농장주소</label>
                                        <div class="lot-address-autocomplete-wrapper">
                                            <input type="text" id="farmAddressFull" name="farmAddressFull"
                                                placeholder="마을명 + 번지 입력 (예: 내성리 123, 내성리 산 45) 후 Enter">
                                            <ul class="lot-address-autocomplete-list" id="farmAddressAutocomplete"></ul>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-field full">
                                        <label for="farmArea">면적</label>
                                        <div class="area-input-wrapper">
                                            <input type="text" id="farmArea" name="farmArea" placeholder="면적" inputmode="numeric">
                                            <div class="area-unit-toggle" id="areaUnitToggle" data-unit="m2">
                                                <button type="button" class="unit-btn active" data-value="m2">㎡</button>
                                                <button type="button" class="unit-btn" data-value="pyeong">평</button>
                                            </div>
                                        </div>
                                        <input type="hidden" id="farmAreaUnit" name="farmAreaUnit" value="m2">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 오른쪽: 의뢰내용 -->
                    <div class="form-right-column">
                        <!-- 의뢰내용 카드 -->
                        <div class="form-card">
                            <div class="card-header">
                                <span class="card-icon">📋</span>
                                <h3>의뢰내용</h3>
                            </div>
                            <div class="card-body">
                                <!-- 시료종류 -->
                                <div class="form-row single">
                                    <div class="form-field full-width">
                                        <label>시료종류 <span class="required">*</span></label>
                                        <div class="sample-type-options">
                                            <label class="checkbox-card">
                                                <input type="radio" name="sampleType" value="가축분퇴비" checked>
                                                <div class="checkbox-content">
                                                    <span class="checkbox-icon">🌿</span>
                                                    <span class="checkbox-label">가축분퇴비</span>
                                                </div>
                                            </label>
                                            <label class="checkbox-card">
                                                <input type="radio" name="sampleType" value="가축분뇨발효액">
                                                <div class="checkbox-content">
                                                    <span class="checkbox-icon">💧</span>
                                                    <span class="checkbox-label">가축분뇨발효액</span>
                                                </div>
                                            </label>
                                        </div>
                                    </div>
                                </div>

                                <!-- 축종 -->
                                <div class="form-row single">
                                    <div class="form-field full-width">
                                        <label>축종 <span class="required">*</span></label>
                                        <div class="animal-type-options">
                                            <label class="checkbox-card small">
                                                <input type="radio" name="animalType" value="소">
                                                <div class="checkbox-content">
                                                    <span class="checkbox-icon">🐄</span>
                                                    <span class="checkbox-label">소</span>
                                                </div>
                                            </label>
                                            <label class="checkbox-card small">
                                                <input type="radio" name="animalType" value="돼지">
                                                <div class="checkbox-content">
                                                    <span class="checkbox-icon">🐷</span>
                                                    <span class="checkbox-label">돼지</span>
                                                </div>
                                            </label>
                                            <label class="checkbox-card small">
                                                <input type="radio" name="animalType" value="닭·오리 등">
                                                <div class="checkbox-content">
                                                    <span class="checkbox-icon">🐔</span>
                                                    <span class="checkbox-label">닭·오리 등</span>
                                                </div>
                                            </label>
                                            <label class="checkbox-card small">
                                                <input type="radio" name="animalType" value="기타">
                                                <div class="checkbox-content">
                                                    <span class="checkbox-icon">📦</span>
                                                    <span class="checkbox-label">기타</span>
                                                </div>
                                            </label>
                                        </div>
                                        <input type="text" id="animalTypeOther" name="animalTypeOther"
                                            placeholder="기타 축종 입력" class="other-input hidden">
                                    </div>
                                </div>

                                <!-- 채취/생산 년월일 -->
                                <div class="form-row">
                                    <div class="form-field">
                                        <label for="productionDate">채취 년 월 일 (생산 년 월 일)</label>
                                        <input type="date" id="productionDate" name="productionDate">
                                    </div>
                                    <div class="form-field">
                                        <label for="sampleCount">시료수</label>
                                        <input type="number" id="sampleCount" name="sampleCount" min="1" value="1">
                                    </div>
                                </div>

                                <!-- 검사에 따른 자료 -->
                                <div class="form-row single">
                                    <div class="form-field full">
                                        <label for="rawMaterials">검사에 따른 자료</label>
                                        <textarea id="rawMaterials" name="rawMaterials" rows="2"
                                            placeholder="예: 우분 60%, 톱밥 30%, 왕겨 10%"></textarea>
                                    </div>
                                </div>

                                <!-- 목적 -->
                                <div class="form-row single">
                                    <div class="form-field full">
                                        <label for="purpose">목적(용도)</label>
                                        <input type="text" id="purpose" name="purpose" placeholder="목적(용도) 입력">
                                    </div>
                                </div>

                                <!-- 비고 -->
                                <div class="form-row single">
                                    <div class="form-field full">
                                        <label for="note">비고</label>
                                        <input type="text" id="note" name="note" placeholder="추가 메모">
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </form>
        </div>

        <!-- 접수 목록 뷰 -->
        <div id="listView" class="view">
            <div class="view-header-top">
                <div class="header-left">
                    <h2 id="listViewTitle">퇴·액비 접수 목록</h2>
                    <select id="listYearSelect" class="list-year-select" title="연도 선택">
                        <option value="2025">2025년</option>
                        <option value="2026">2026년</option>
                        <option value="2027">2027년</option>
                        <option value="2028">2028년</option>
                        <option value="2029">2029년</option>
                        <option value="2030">2030년</option>
                    </select>
                    <select id="completedFilter" class="purpose-filter appearance-none">
                        <option value="">전체 상태</option>
                        <option value="incomplete">⬜ 미완료</option>
                        <option value="completed">✅ 완료</option>
                    </select>
                    <span class="record-count" id="recordCount">0건</span>
                </div>
                <div class="header-right">
                    <div class="view-toggle">
                        <button type="button" id="toggleColumnsBtn" class="btn-view-toggle" title="전체 보기/기본 보기">
                            <span class="toggle-icon">👁️</span>
                            <span class="toggle-text">전체 보기</span>
                        </button>
                    </div>
                    <button type="button" id="statsBtn" class="btn-statistics" title="통계">
                        📊 통계
                    </button>
                    <button type="button" id="printLabelBtn" class="btn-label-print" title="선택한 항목 라벨 인쇄">
                        🏷️ 라벨 인쇄
                    </button>
                    <button type="button" id="deleteSelectedBtn" class="btn-bulk-delete" title="선택한 항목 일괄 삭제">
                        🗑️ 선택 삭제
                    </button>
                    <button type="button" id="btnBulkMailDate" class="btn-bulk-mail" title="선택한 항목 우편발송일자 일괄 입력">
                        📮 발송일자
                    </button>
                    <button type="button" id="openSearchModalBtn" class="btn-search-open" title="검색">
                        🔍 검색
                    </button>
                </div>
            </div>
            <div class="table-wrapper">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th class="col-checkbox">
                                <input type="checkbox" id="selectAllCheckbox" title="전체 선택">
                            </th>
                            <th class="col-complete">완료</th>
                            <th class="col-result">판정</th>
                            <th class="col-maturity">부숙도</th>
                            <th class="col-moisture">함수율</th>
                            <th>접수번호</th>
                            <th>접수일자</th>
                            <th class="col-applicant-type col-hidden">법인여부</th>
                            <th class="col-birth-corp col-hidden">생년월일/법인번호</th>
                            <th>농장명</th>
                            <th>대표자</th>
                            <th class="col-postcode col-hidden">우편번호</th>
                            <th class="col-address">주소</th>
                            <th class="col-farm-address">농장주소</th>
                            <th>면적</th>
                            <th>시료종류</th>
                            <th>축종</th>
                            <th>생산일</th>
                            <th>목적</th>
                            <th>연락처</th>
                            <th>통보방법</th>
                            <th class="col-note">비고</th>
                            <th class="col-mail-date">발송일자</th>
                            <th class="col-action">관리</th>
                        </tr>
                    </thead>
                    <tbody id="logTableBody">
                        <!-- 데이터가 여기에 추가됩니다 -->
                    </tbody>
                </table>
                <!-- 페이지네이션 -->
                <div id="pagination" class="pagination-container">
                    <div class="pagination-info">
                        <span id="paginationInfo">0건 중 0-0</span>
                        <select id="itemsPerPage" class="items-per-page">
                            <option value="50">50건</option>
                            <option value="100" selected>100건</option>
                            <option value="200">200건</option>
                            <option value="500">500건</option>
                        </select>
                    </div>
                    <div class="pagination-controls">
                        <button id="firstPage" class="pagination-btn" title="처음">«</button>
                        <button id="prevPage" class="pagination-btn" title="이전">‹</button>
                        <div id="pageNumbers" class="page-numbers"></div>
                        <button id="nextPage" class="pagination-btn" title="다음">›</button>
                        <button id="lastPage" class="pagination-btn" title="마지막">»</button>
                    </div>
                </div>
                <div id="emptyState" class="empty-state">
                    <div class="empty-icon">📭</div>
                    <p>등록된 접수 내역이 없습니다</p>
                    <button type="button" class="btn-go-form">새 시료 접수하기</button>
                </div>
            </div>
        </div>
    </main>

    <!-- 주소 검색 모달 -->
    <div id="addressModal" class="modal hidden">
        <div class="modal-overlay"></div>
        <div class="modal-content address-modal-content">
            <div class="modal-header">
                <h3>🏠 주소 검색</h3>
                <button type="button" class="modal-close" id="closeAddressModal">&times;</button>
            </div>
            <div class="modal-body">
                <div id="daumPostcodeContainer" class="postcode-container"></div>
            </div>
        </div>
    </div>

    <!-- 등록 결과 모달 -->
    <div id="registrationResultModal" class="modal hidden">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3>📋 등록 결과</h3>
                <button type="button" class="modal-close" id="closeRegistrationModal">&times;</button>
            </div>
            <div class="modal-body">
                <table class="result-table">
                    <tbody id="resultTableBody">
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary" id="closeResultBtn">닫기</button>
                <button type="button" class="btn-secondary" id="editResultBtn">수정</button>
                <button type="button" class="btn-primary" id="exportResultBtn">엑셀로 내보내기</button>
            </div>
        </div>
    </div>

    <!-- 통계 모달 -->
    <div id="statsModal" class="modal hidden">
        <div class="modal-overlay"></div>
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3>📊 퇴·액비 접수 통계</h3>
                <button type="button" class="modal-close" id="closeStatsModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="stats-container">
                    <!-- 요약 카드 -->
                    <div class="stats-summary">
                        <div class="stat-card total">
                            <div class="stat-icon">📋</div>
                            <div class="stat-info">
                                <span class="stat-value" id="statTotalCount">0</span>
                                <span class="stat-label">총 접수</span>
                            </div>
                        </div>
                        <div class="stat-card completed">
                            <div class="stat-icon">✅</div>
                            <div class="stat-info">
                                <span class="stat-value" id="statCompletedCount">0</span>
                                <span class="stat-label">완료</span>
                            </div>
                        </div>
                        <div class="stat-card pending">
                            <div class="stat-icon">⏳</div>
                            <div class="stat-info">
                                <span class="stat-value" id="statPendingCount">0</span>
                                <span class="stat-label">미완료</span>
                            </div>
                        </div>
                    </div>

                    <!-- 상세 통계 -->
                    <div class="stats-details">
                        <!-- 시료종류별 -->
                        <div class="stats-section">
                            <h4>📋 시료종류별</h4>
                            <div class="stats-chart" id="statsByCompostType"></div>
                        </div>

                        <!-- 축종별 -->
                        <div class="stats-section">
                            <h4>🐄 축종별</h4>
                            <div class="stats-chart" id="statsByAnimalType"></div>
                        </div>

                        <!-- 수령방법별 -->
                        <div class="stats-section">
                            <h4>📮 수령방법별</h4>
                            <div class="stats-chart" id="statsByReceptionMethod"></div>
                        </div>

                        <!-- 월별 통계 (전체 너비) -->
                        <div class="stats-section stats-section-full">
                            <h4>📅 월별 접수 현황</h4>
                            <div class="stats-chart-monthly" id="statsByMonth"></div>
                            <div class="stats-quarterly" id="statsQuarterly"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-cancel" id="closeStatsBtn2">닫기</button>
            </div>
        </div>
    </div>

    <!-- 접수 목록 검색 모달 -->
    <div id="listSearchModal" class="modal hidden">
        <div class="modal-overlay"></div>
        <div class="modal-content modal-search">
            <div class="modal-header">
                <h3>🔍 검색</h3>
                <button type="button" class="modal-close" id="closeSearchModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="search-modal-form">
                    <div class="search-form-group">
                        <label for="searchDateFromInput">
                            <span class="material-icons-outlined label-icon-calendar">calendar_today</span>
                            접수일자 (범위)
                        </label>
                        <div class="search-input-row">
                            <div class="search-input-wrapper">
                                <input type="date" id="searchDateFromInput" class="search-input" title="시작일">
                            </div>
                            <span class="date-range-separator">~</span>
                            <div class="search-input-wrapper">
                                <input type="date" id="searchDateToInput" class="search-input" title="종료일">
                            </div>
                            <button type="button" id="clearSearchDate" class="btn-clear-field">초기화</button>
                        </div>
                    </div>
                    <div class="search-form-group">
                        <label for="searchNameInput">
                            <span class="material-icons-outlined label-icon-calendar">person</span>
                            성명
                        </label>
                        <input type="text" id="searchNameInput" placeholder="성명 입력..." class="search-input">
                    </div>
                    <div class="search-form-group">
                        <label for="searchReceptionFromInput">
                            <span class="material-icons-outlined label-icon-calendar">tag</span>
                            접수번호 (범위)
                        </label>
                        <div class="search-input-row">
                            <div class="search-input-wrapper">
                                <input type="text" id="searchReceptionFromInput" class="search-input" placeholder="시작 번호">
                            </div>
                            <span class="date-range-separator">~</span>
                            <div class="search-input-wrapper">
                                <input type="text" id="searchReceptionToInput" class="search-input" placeholder="종료 번호">
                            </div>
                            <button type="button" id="clearSearchReception" class="btn-clear-field">초기화</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" id="resetSearchBtn" class="btn-secondary">전체 초기화</button>
                <button type="button" id="applySearchBtn" class="btn-primary">검색</button>
            </div>
        </div>
    </div>

    <!-- 우편발송일자 입력 모달 -->
    <div id="mailDateModal" class="modal hidden">
        <div class="modal-overlay"></div>
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h3>📮 우편발송일자 입력</h3>
                <button type="button" class="modal-close" id="closeMailDateModal">&times;</button>
            </div>
            <div class="modal-body">
                <p id="mailDateInfo" class="mail-date-info">선택한 0건의 우편발송일자를 입력하세요.</p>
                <div class="form-field">
                    <label for="mailDateInput">발송일자</label>
                    <input type="date" id="mailDateInput" class="mail-date-input">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" id="cancelMailDateBtn" class="btn-cancel">취소</button>
                <button type="button" id="confirmMailDateBtn" class="btn-confirm">확인</button>
            </div>
        </div>
    </div>

    <!-- 토스트 컨테이너 -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- 엑셀 가져오기 모달 -->
    <div id="excelImportModal" class="modal hidden">
        <div class="modal-overlay"></div>
        <div class="modal-content modal-xlarge">
            <div class="modal-header">
                <h3>📊 엑셀 파일 가져오기</h3>
                <button type="button" class="modal-close" id="closeExcelImportModal">&times;</button>
            </div>
            <div class="modal-body">
                <div id="excelImportStep1">
                    <p class="import-step-title">1단계: 공통 정보 입력</p>
                    <p class="import-step-desc">엑셀에 없는 공통 정보를 입력하세요. 엑셀 데이터에 해당 열이 있으면 엑셀 값이 우선됩니다.</p>
                    <div class="import-common-fields">
                        <div class="import-field-row">
                            <div class="import-field">
                                <label for="importDate">접수일자 <span class="required">*</span></label>
                                <input type="date" id="importDate" required>
                            </div>
                            <div class="import-field">
                                <label for="importName">대표자 성명</label>
                                <input type="text" id="importName" placeholder="성명">
                            </div>
                            <div class="import-field">
                                <label for="importPhone">전화번호</label>
                                <input type="text" id="importPhone" placeholder="010-0000-0000">
                            </div>
                        </div>
                        <div class="import-field-row">
                            <div class="import-field">
                                <label for="importAddress">주소</label>
                                <input type="text" id="importAddress" placeholder="주소">
                            </div>
                            <div class="import-field">
                                <label for="importMethod">통보방법</label>
                                <select id="importMethod">
                                    <option value="우편">우편</option>
                                    <option value="이메일">이메일</option>
                                    <option value="팩스">팩스</option>
                                    <option value="방문">방문</option>
                                </select>
                            </div>
                            <div class="import-field">
                                <label for="importPurpose">검사목적</label>
                                <input type="text" id="importPurpose" placeholder="검사목적/용도" value="비료공정규격">
                            </div>
                        </div>
                    </div>
                    <div class="import-template-area">
                        <button type="button" id="downloadTemplateBtn" class="btn-template-download">📄 엑셀 서식 다운로드</button>
                        <span class="template-hint">서식에 맞춰 데이터를 입력하면 컬럼 매핑이 자동으로 됩니다.</span>
                    </div>
                </div>
                <div id="excelImportStep2" class="hidden">
                    <p class="import-step-title">2단계: 컬럼 매핑</p>
                    <p class="import-step-desc">엑셀 열을 앱 필드에 매핑하세요. 자동 매핑이 완료되었습니다.</p>
                    <div id="columnMappingArea" class="column-mapping-area"></div>
                </div>
                <div id="excelImportStep3" class="hidden">
                    <p class="import-step-title">3단계: 데이터 미리보기</p>
                    <p class="import-step-desc" id="previewSummary">총 0건의 데이터를 가져옵니다.</p>
                    <div id="previewTableWrap" class="preview-table-wrap">
                        <table id="previewTable" class="preview-table">
                            <thead id="previewTableHead"></thead>
                            <tbody id="previewTableBody"></tbody>
                        </table>
                    </div>
                    <div id="importWarnings" class="import-warnings hidden"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" id="excelImportPrevBtn" class="btn-cancel hidden">이전</button>
                <div class="modal-footer-spacer"></div>
                <button type="button" id="cancelExcelImportBtn" class="btn-cancel">취소</button>
                <button type="button" id="excelImportNextBtn" class="btn-confirm">다음</button>
            </div>
        </div>
    </div>

    <!-- 다음 우편번호 서비스 -->
    <script src="https://t1.kakaocdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <!-- XLSX 라이브러리 -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <!-- 봉화 지역 데이터 (자동완성용) -->
    <script src="../bonghwaData.js"></script>
    <!-- 공통 모듈 -->
    <!-- DOMPurify for XSS prevention -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.0.6/purify.min.js" integrity="sha384-cwS6YdhLI7XS60eoDiC+egV0qHp8zI+Cms46R0nbn8JrmoAzV9uFL60etMZhAnSu" crossorigin="anonymous"></script>
    <script src="../shared/sanitize.js"></script>
    <script src="../shared/constants.js"></script>
    <script src="../shared/file-api.js"></script>
    <script src="../shared/utils.js"></script>
    <script src="../shared/toast.js"></script>
    <script src="../shared/pagination.js"></script>
    <script src="../shared/address.js"></script>
    <script src="../shared/address-parser.js"></script>
    <script src="../shared/search-filter.js"></script>
    <script src="../shared/form-validator.js"></script>
    <script src="../shared/theme.js"></script>
    <script src="../shared/tooltip.js"></script>
    <!-- Firebase SDK (compat 버전 - Electron 호환) -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <!-- 네트워크 접근 제어 (Firebase 초기화 전에 로드) -->
    <script src="../shared/logger.js"></script>
    <script src="../shared/network-config.js"></script>
    <script src="../shared/network-access.js"></script>
    <!-- Firebase 스크립트 -->
    <script src="../shared/firebase-config.js"></script>
    <script src="../shared/firestore-db.js"></script>
    <script src="../shared/sync-utils.js"></script>
    <script src="../shared/BaseSampleManager.js"></script>
    <!-- 메인 스크립트 -->
    <script src="compost-script.js"></script>
</body>

</html>
